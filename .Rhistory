### Finding differences between contacts ###
### 2025-08-16 21:02 PT ###
# packages
library(dplyr)
# reading tsv files
contacts_1ITB <- read.table(
"~/Dropbox/getcontacts/receptors_il1b/1itb_contacts.tsv",
skip = 2,
header = FALSE,
fill = TRUE,
stringsAsFactors = FALSE
)
contacts_3O4O <- read.table(
"~/Dropbox/getcontacts/receptors_il1b/3o4o_contacts.tsv",
skip = 2,
header = FALSE,
fill = TRUE,
stringsAsFactors = FALSE
)
colnames(contacts_1ITB) <- c("frame", "interaction_type", "atom1", "atom2")
colnames(contacts_3O4O) <- c("frame", "interaction_type", "atom1", "atom2")
# unique contacts
unique_1ITB_contacts <- anti_join(contacts_1ITB, contacts_3O4O,
by = c("interaction_type", "atom1", "atom2"))
unique_1ITB_contacts
unique_1ITB_contacts
unique_1ITB_contacts
unique_1ITB_contacts <- anti_join(contacts_1ITB, contacts_3O4O,
by = c("interaction_type", "atom1", "atom2") %>%
filter(interaction_type != "vdw"))
unique_1ITB_contacts <- anti_join(contacts_1ITB, contacts_3O4O,
by = c("interaction_type", "atom1", "atom2") %>%
filter("interaction_type" != "vdw"))
unique_1ITB_contacts <- anti_join(
contacts_1ITB,
contacts_3O4O,
by = c("interaction_type", "atom1", "atom2") %>%
filter(interaction_type != "vdw")
)
unique_1ITB_contacts <- contacts_1ITB %>%
filter(interaction_type != "vdw") %>%
anti_join(
contacts_3O4O %>% filter(interaction_type != "vdw"),
by = c("interaction_type", "atom1", "atom2")
)
unique_1ITB_contacts
unique_1ITB_contacts <- contacts_3O4O %>%
filter(interaction_type != "vdw") %>%
anti_join(
contacts_3O4O %>% filter(interaction_type != "vdw"),
by = c("interaction_type", "atom1", "atom2")
)
unique_3040_contacts <- contacts_3O4O %>%
filter(interaction_type != "vdw") %>%
anti_join(
contacts_3O4O %>% filter(interaction_type != "vdw"),
by = c("interaction_type", "atom1", "atom2")
)
unique_1ITB_contacts <- contacts_1ITB %>%
filter(interaction_type != "vdw") %>%
anti_join(
contacts_3O4O %>% filter(interaction_type != "vdw"),
by = c("interaction_type", "atom1", "atom2")
)
unique_3040_contacts
unique_3040_contacts <- contacts_3O4O %>%
filter(interaction_type != "vdw") %>%
anti_join(
contacts_3O4O %>% filter(interaction_type != "vdw"),
by = c("interaction_type", "atom1", "atom2")
)
unique_3040_contacts
unique_1ITB_contacts
c1ITB <- contacts_1ITB %>% filter(interaction_type != "vdw")
c3O4O <- contacts_3O4O %>% filter(interaction_type != "vdw")
unique_contacts <- dplyr::union(c1, c3) %>%
anti_join(
dplyr::intersect(c1, c3),
by = c("interaction_type", "atom1", "atom2")
)
unique_contacts <- dplyr::union(c1ITB, c3O4O) %>%
anti_join(
dplyr::intersect(c1, c3),
by = c("interaction_type", "atom1", "atom2")
)
unique_contacts <- dplyr::union(c1ITB, c3O4O) %>%
anti_join(
dplyr::intersect(c1, c3),
by = c("interaction_type", "atom1", "atom2")
)
colnames(c1ITB) <- c("frame", "interaction_type", "atom1", "atom2")
colnames(c3O4O) <- c("frame", "interaction_type", "atom1", "atom2")
unique_contacts <- dplyr::union(c1ITB, c3O4O) %>%
anti_join(
dplyr::intersect(c1, c3),
by = c("interaction_type", "atom1", "atom2")
)
unique_contacts <- dplyr::union(c1ITB, c3O4O) %>%
anti_join(
dplyr::intersect(c1ITB, c3040),
by = c("interaction_type", "atom1", "atom2")
)
### Finding differences between contacts ###
### 2025-08-16 21:02 PT ###
# packages
library(dplyr)
# reading tsv files
contacts_1ITB <- read.table(
"~/Dropbox/getcontacts/receptors_il1b/1itb_contacts.tsv",
skip = 2,
header = FALSE,
fill = TRUE,
stringsAsFactors = FALSE
)
contacts_3O4O <- read.table(
"~/Dropbox/getcontacts/receptors_il1b/3o4o_contacts.tsv",
skip = 2,
header = FALSE,
fill = TRUE,
stringsAsFactors = FALSE
)
# filtering
c1ITB <- contacts_1ITB %>% filter(interaction_type != "vdw")
c1ITB <- contacts_1ITB %>% filter("interaction_type" != "vdw")
c3O4O <- contacts_3O4O %>% filter("interaction_type" != "vdw")
c1ITB <- contacts_1ITB %>% filter("interaction_type" != "vdw")
c3O4O <- contacts_3O4O %>% filter("interaction_type" != "vdw")
colnames(c1ITB) <- c("frame", "interaction_type", "atom1", "atom2")
colnames(c3O4O) <- c("frame", "interaction_type", "atom1", "atom2")
# unique contacts
unique_contacts <- dplyr::union(c1ITB, c3O4O) %>%
anti_join(
dplyr::intersect(c1ITB, c3040),
by = c("interaction_type", "atom1", "atom2")
)
rlang::last_trace()
c1ITB_sel <- c1ITB %>% select(interaction_type, atom1, atom2)
c3O4O_sel <- c3O4O %>% select(interaction_type, atom1, atom2)
unique_contacts <- dplyr::union(c1ITB_sel, c3O4O_sel) %>%
anti_join(
dplyr::intersect(c1ITB_sel, c3O4O_sel),
by = c("interaction_type", "atom1", "atom2")
)
unique_contacts
colnames(c1ITB_sel) <- c("frame", "interaction_type", "atom1", "atom2")
colnames(c1ITB_sel) <- c("interaction_type", "atom1", "atom2")
colnames(c3O4O_sel) <- c("interaction_type", "atom1", "atom2")
### Finding differences between contacts ###
### 2025-08-16 21:02 PT ###
# packages
library(dplyr)
# reading tsv files
contacts_1ITB <- read.table(
"~/Dropbox/getcontacts/receptors_il1b/1itb_contacts.tsv",
skip = 2,
header = FALSE,
fill = TRUE,
stringsAsFactors = FALSE
)
contacts_3O4O <- read.table(
"~/Dropbox/getcontacts/receptors_il1b/3o4o_contacts.tsv",
skip = 2,
header = FALSE,
fill = TRUE,
stringsAsFactors = FALSE
)
# filtering
c1ITB_sel <- contacts_1ITB %>% select(interaction_type, atom1, atom2)
c1ITB_sel <- contacts_1ITB %>% select(interaction_type, atom1, atom2)
### Finding differences between contacts ###
### 2025-08-16 21:02 PT ###
# packages
library(dplyr)
# reading tsv files
contacts_1ITB <- read.table(
"~/Dropbox/getcontacts/receptors_il1b/1itb_contacts.tsv",
skip = 2,
header = FALSE,
fill = TRUE,
stringsAsFactors = FALSE
)
contacts_3O4O <- read.table(
"~/Dropbox/getcontacts/receptors_il1b/3o4o_contacts.tsv",
skip = 2,
header = FALSE,
fill = TRUE,
stringsAsFactors = FALSE
)
# filtering
c1ITB_sel <- contacts_1ITB %>% select(interaction_type, atom1, atom2)
### Finding differences between contacts ###
### 2025-08-16 21:02 PT ###
# packages
library(dplyr)
# reading tsv files
contacts_1ITB <- read.table(
"~/Dropbox/getcontacts/receptors_il1b/1itb_contacts.tsv",
skip = 2,
header = FALSE,
fill = TRUE,
stringsAsFactors = FALSE
)
contacts_3O4O <- read.table(
"~/Dropbox/getcontacts/receptors_il1b/3o4o_contacts.tsv",
skip = 2,
header = FALSE,
fill = TRUE,
stringsAsFactors = FALSE
)
# filtering
colnames(c1ITB_sel) <- c("interaction_type", "atom1", "atom2")
colnames(c3O4O_sel) <- c("interaction_type", "atom1", "atom2")
c1ITB_sel <- contacts_1ITB %>% select(interaction_type, atom1, atom2)
colnames(c1ITB_sel) <- c("interaction_type", "atom1", "atom2")
colnames(c3O4O_sel) <- c("interaction_type", "atom1", "atom2")
c1ITB_sel <- contacts_1ITB %>% select(interaction_type, atom1, atom2)
colnames(c1ITB_sel) <- c("interaction_type", "atom1", "atom2")
colnames(c3O4O_sel) <- c("interaction_type", "atom1", "atom2")
c1ITB_sel <- contacts_1ITB %>% select(interaction_type, atom1, atom2)
colnames(contacts_1ITB) <- c("frames", "interaction_type", "atom1", "atom2")
colnames(contacts_3O4O) <- c("frames", "interaction_type", "atom1", "atom2")
c1ITB_sel <- contacts_1ITB %>% select(interaction_type, atom1, atom2)
c3O4O_sel <- contacts_3O4O %>% select(interaction_type, atom1, atom2)
unique_contacts <- dplyr::union(c1ITB_sel, c3O4O_sel) %>%
anti_join(
dplyr::intersect(c1ITB_sel, c3O4O_sel),
by = c("interaction_type", "atom1", "atom2")
)
unique_contacts
unique_contacts %>% filter(interaction_type != "vdw")
write.csv(unique_contacts,
"~/Dropbox/getcontacts/receptors_il1b/unique_contacts.csv",
row.names = FALSE)
write.csv(unique_contacts %>% filter(interaction_type != "vdw"),
"~/Dropbox/getcontacts/receptors_il1b/unique_contacts.csv",
row.names = FALSE)
nrow(unique_contacts)
ncol(unique_contacts)
filter(atom1_1ITB != atom1_3O4O | atom2_1ITB != atom2_3O4O | interaction_type != "vdw")
### Finding differences between contacts ###
### 2025-08-16 21:02 PT ###
# packages
library(dplyr)
# reading tsv files
contacts_1ITB <- read.table(
"~/Dropbox/getcontacts/receptors_il1b/1itb_contacts.tsv",
skip = 2,
header = FALSE,
fill = TRUE,
stringsAsFactors = FALSE
)
contacts_3O4O <- read.table(
"~/Dropbox/getcontacts/receptors_il1b/3o4o_contacts.tsv",
skip = 2,
header = FALSE,
fill = TRUE,
stringsAsFactors = FALSE
)
# column names and selections
colnames(contacts_1ITB) <- c("frames", "interaction_type", "atom1", "atom2")
colnames(contacts_3O4O) <- c("frames", "interaction_type", "atom1", "atom2")
c1ITB_sel <- contacts_1ITB %>% select(interaction_type, atom1, atom2)
c3O4O_sel <- contacts_3O4O %>% select(interaction_type, atom1, atom2)
# full join by interaction type to comp
compare_contacts <- full_join(c1ITB_sel, c3O4O_sel, by = "interaction_type")
# unique contacts
unique_contacts <- compare_contacts %>%
filter(atom1_1ITB != atom1_3O4O | atom2_1ITB != atom2_3O4O | interaction_type != "vdw")
### Finding differences between contacts ###
### 2025-08-16 21:02 PT ###
# packages
library(dplyr)
# reading tsv files
contacts_1ITB <- read.table(
"~/Dropbox/getcontacts/receptors_il1b/1itb_contacts.tsv",
skip = 2,
header = FALSE,
fill = TRUE,
stringsAsFactors = FALSE
)
contacts_3O4O <- read.table(
"~/Dropbox/getcontacts/receptors_il1b/3o4o_contacts.tsv",
skip = 2,
header = FALSE,
fill = TRUE,
stringsAsFactors = FALSE
)
# column names and selections
colnames(contacts_1ITB) <- c("frames", "interaction_type", "atom1", "atom2")
colnames(contacts_3O4O) <- c("frames", "interaction_type", "atom1", "atom2")
c1ITB_sel <- contacts_1ITB %>% select(interaction_type, atom1, atom2)
c3O4O_sel <- contacts_3O4O %>% select(interaction_type, atom1, atom2)
# full join by interaction type to comp
compare_contacts <- full_join(c1ITB_sel, c3O4O_sel, by = "interaction_type")
# full join by interaction type to comp
compare_contacts <- full_join(c1ITB_sel, c3O4O_sel, by = "interaction_type")
# unique contacts
unique_contacts <- compare_contacts %>%
filter(atom1_1ITB != atom1_3O4O | contacts_1ITB$atom2 != contacts_3O4O$atom2 | interaction_type != "vdw")
### Finding differences between contacts ###
### 2025-08-16 21:02 PT ###
# packages
library(dplyr)
# reading tsv files
contacts_1ITB <- read.table(
"~/Dropbox/getcontacts/receptors_il1b/1itb_contacts.tsv",
skip = 2,
header = FALSE,
fill = TRUE,
stringsAsFactors = FALSE
)
contacts_3O4O <- read.table(
"~/Dropbox/getcontacts/receptors_il1b/3o4o_contacts.tsv",
skip = 2,
header = FALSE,
fill = TRUE,
stringsAsFactors = FALSE
)
# column names and selections
colnames(contacts_1ITB) <- c("frames", "interaction_type", "atom1", "atom2")
colnames(contacts_3O4O) <- c("frames", "interaction_type", "atom1", "atom2")
c1ITB_sel <- contacts_1ITB %>% select(interaction_type, atom1, atom2)
c3O4O_sel <- contacts_3O4O %>% select(interaction_type, atom1, atom2)
# full join by interaction type to comp
compare_contacts <- full_join(c1ITB_sel, c3O4O_sel, by = "interaction_type")
# unique contacts
unique_contacts <- compare_contacts %>%
filter(contacts_1ITB$atom1 != contacts_3O4O$atom1 | contacts_1ITB$atom2 != contacts_3O4O$atom2 | interaction_type != "vdw")
unique_contacts
write.csv(unique_contacts)
head(unique_contacts)
write.csv(unique_contacts,
"~/Dropbox/getcontacts/receptors_il1b/unique_contacts.csv",
row.names = FALSE)
### Finding differences between contacts ###
### 2025-08-16 21:02 PT ###
# packages
library(dplyr)
# reading tsv files
contacts_1ITB <- read.table(
"~/Dropbox/getcontacts/receptors_il1b/1itb_contacts.tsv",
skip = 2,
header = FALSE,
fill = TRUE,
stringsAsFactors = FALSE
)
contacts_3O4O <- read.table(
"~/Dropbox/getcontacts/receptors_il1b/3o4o_contacts.tsv",
skip = 2,
header = FALSE,
fill = TRUE,
stringsAsFactors = FALSE
)
# column names and selections
colnames(contacts_1ITB) <- c("frames", "interaction_type", "atom1", "atom2")
colnames(contacts_3O4O) <- c("frames", "interaction_type", "atom1", "atom2")
c1ITB_sel <- contacts_1ITB %>% select(interaction_type, atom1, atom2) %>% filter(interaction_type != "vdw")
c3O4O_sel <- contacts_3O4O %>% select(interaction_type, atom1, atom2) %>% filter(interaction_type != "vdw")
# unique to 1ITB (by atom pairs only)
unique_1ITB <- anti_join(
c1ITB_sel, c3O4O_sel, by = c("atom1", "atom2")
)
# unique to 3O4O (by atom pairs only)
unique_3O4O <- anti_join(
c3O4O_sel, c1ITB_sel, by = c("atom1", "atom2")
)
unique_contacts <- bind_rows(
unique_1ITB %>% mutate(source = "1ITB") %>%
filter(interaction_type != "vdw"),
unique_3O4O %>% mutate(source = "3O4O") %>%
filter(interaction_type != "vdw")
)
write.csv(unique_contacts,
"~/Dropbox/getcontacts/receptors_il1b/unique_contacts.csv",
row.names = FALSE)
### Finding differences between contacts ###
### 2025-08-16 21:02 PT ###
# packages
library(dplyr)
# reading tsv files
contacts_1ITB <- read.table(
"~/Dropbox/getcontacts/receptors_il1b/1itb_contacts.tsv",
skip = 2,
header = FALSE,
fill = TRUE,
stringsAsFactors = FALSE
)
contacts_3O4O <- read.table(
"~/Dropbox/getcontacts/receptors_il1b/3o4o_contacts.tsv",
skip = 2,
header = FALSE,
fill = TRUE,
stringsAsFactors = FALSE
)
# column names and selections
colnames(contacts_1ITB) <- c("frames", "interaction_type", "atom1", "atom2")
colnames(contacts_3O4O) <- c("frames", "interaction_type", "atom1", "atom2")
c1ITB_sel <- contacts_1ITB %>% select(interaction_type, atom1, atom2)
c3O4O_sel <- contacts_3O4O %>% select(interaction_type, atom1, atom2)
# unique to 1ITB (by atom pairs only)
unique_1ITB <- anti_join(
c1ITB_sel, c3O4O_sel, by = c("atom1", "atom2")
)
# unique to 3O4O (by atom pairs only)
unique_3O4O <- anti_join(
c3O4O_sel, c1ITB_sel, by = c("atom1", "atom2")
)
unique_contacts <- bind_rows(
unique_1ITB %>% mutate(source = "1ITB") %>%
filter(interaction_type != "vdw"),
unique_3O4O %>% mutate(source = "3O4O") %>%
filter(interaction_type != "vdw")
)
write.csv(unique_contacts,
"~/Dropbox/getcontacts/receptors_il1b/unique_contacts.csv",
row.names = FALSE)
### Finding differences between contacts ###
### 2025-08-16 21:02 PT ###
# packages
library(dplyr)
# reading tsv files
contacts_1ITB <- read.table(
"~/Dropbox/getcontacts/receptors_il1b/1itb_contacts.tsv",
skip = 2,
header = FALSE,
fill = TRUE,
stringsAsFactors = FALSE
)
contacts_3O4O <- read.table(
"~/Dropbox/getcontacts/receptors_il1b/3o4o_contacts.tsv",
skip = 2,
header = FALSE,
fill = TRUE,
stringsAsFactors = FALSE
)
# column names and selections
colnames(contacts_1ITB) <- c("frames", "interaction_type", "atom1", "atom2")
colnames(contacts_3O4O) <- c("frames", "interaction_type", "atom1", "atom2")
c1ITB_sel <- contacts_1ITB %>% select(interaction_type, atom1, atom2)
c3O4O_sel <- contacts_3O4O %>% select(interaction_type, atom1, atom2)
# unique to 1ITB (by atom pairs only)
unique_1ITB <- anti_join(
c1ITB_sel, c3O4O_sel, by = c("atom1", "atom2")
)
# unique to 3O4O (by atom pairs only)
unique_3O4O <- anti_join(
c3O4O_sel, c1ITB_sel, by = c("atom1", "atom2")
)
unique_contacts <- bind_rows(
unique_1ITB %>% mutate(source = "1ITB") %>%
filter(interaction_type != "vdw"),
unique_3O4O %>% mutate(source = "3O4O") %>%
filter(interaction_type != "vdw")
)
write.csv(unique_contacts,
"~/Dropbox/getcontacts/receptors_il1b/unique_contacts.csv",
row.names = FALSE)
length(unique_contacts)
head(unique_contacts)
